# 📝 학습 일지  
**날짜:** 2025.07.11 ~ 2025.07.13  

- [X] WebServer 구조 변경
   - [X] HttpRequest, HttpResponse 분리
   - [X] HttpStatus enum 생성
   - [X] 경로 처리 response handler 생성
- [X] 금요일 피드백 사항 반영
   - [X] ThreadPoolExecutor 스레드 개수 변경
   - [X] Http OWS 처리
   - [X] 로그 상세 설명 추가
- [X] 단위 테스트 작성 (회원가입 성공/실패, OWS 정상 작동 여부)  
<br/>

## 💡 오늘의 주요 고민 사항

### 1. Web Server 구조 리팩토링 — 객체 분리의 이유는?

기존에는 요청과 응답 처리를 RequestHandler에서 단순한 문자열 파싱 및 출력으로 모두 처리했다. 하지만 주말동안 리팩토링을 진행하며, **HttpRequest / HttpResponse 객체를 분리**했다.  

그 이유는 각 객체가 가져야 할 책임이 명확하게 나뉘어야 **기능 확장과 유지보수에 유리하기 때문**이다.  
그런점에서 MIME 타입 반영과 API 요청과 처리를 구현할 때 수정 사항이 많다는 점은 '유지보수성이 좋은 코드가 아니다' 라는 생각이 들었다.
- `HttpRequest` : 요청을 파싱하고 구조화하는 책임  
- `HttpResponse` : 상태 코드와 응답 header, body 구성의 책임  

이렇게 책임을 나누면 이후에 API 전용 핸들러나 동적 라우팅을 추가하더라도, 기존 로직을 건드리지 않고 확장할 수 있다.  
> 결국, 변경에 유연한 구조는 책임을 나누는 것에서 시작된다는 걸 깨달았다.  

### 2. 하드 코딩을 줄이기 — 상태 코드 enum화

처음에는 `200 OK`, `404 Not Found` 같은 상태 코드를 문자열로 직접 작성하며 처리했다.  
하지만 작업을 반복하면서 **휴먼 에러**가 발생하기 쉬웠고, 코드의 **일관성 유지**에도 어려움을 느꼈다.  

그래서 `enum HttpStatus`를 만들어 상태값을 관리하게 되었다.  
- 각 상태 코드에 대한 의미 부여가 명확해짐
- 오타 방지 및 IDE 자동완성을 통한 개발 효율성 향상  
- 새로운 상태 코드가 생겼을 때 한 곳에서 관리 가능  

### 3. 테스트 코드는 어디서부터 시작해야 할까?

처음에는 테스트 코드를 어디부터, 어떻게 작성해야 할지 막막했다.  
그래서 **명확한 동작 기준이 있는 기능부터 단위 테스트를 작성**해보기로 했다.  

테스트 기준:  
- **회원가입 성공 / 실패 케이스 확인**  
  - 필수값 누락 요청 테스트  
- **OWS (One Write Stream)** 응답이 잘 되는지 확인  
  - Http 요청에 공백이 있더라도 정상적으로 요청을 파싱할 수 있는지 확인 

이전에는 변경사항이 생기면 재실행해서 화면이나 postman 같은 외부 툴을 통해 수동 확인했는데, 이렇게 기능 테스트 코드를 짜두니 변경사항이 생겨도 테스트를 빠르게 진행할 수 있었다. 
그리고 한 편으론 단위 테스트를 통해 단순히 “돌아간다”가 아닌, “의도한 대로 동작한다”는 확신을 얻을 수 있었다.  

<br/>

## 🔧 앞으로의 과제  

1. **부하 테스트 도구 학습 및 적용**  
   - wrk를 사용해 부하 테스트를 진행해보려 했으나, read error가 많이 발생
   - 원인 분석해보고 JMeter와 같은 다른 부하 테스트 툴 적용해보기

2. **Object 도서 읽고, Web Server 리팩토링 계속 진행**
   - 수업시간에 추천받은 Object 도서 읽고 객체지향에 대해 추가 학습 (주말에 책을 빌려왔다!)
   - API가 계속 추가되었을 때 어떻게 관리할지 고민

3. **Request 파라미터 유효성 검증 로직 추가**  
   - 회원가입에서 발생할 수 있는 실패 상황에 대해 추가 테스트 코드 작성해보기 (중복 아이디, type에 맞지 않는 값 입력)

<br/>

## ✨ 느낀 점

### 칭찬  
- 구조 개선과 책임 분리에 대한 고민을 하며 객체 분리를 시도한 점  
- 하드 코딩된 상태값을 enum으로 치환해 코드 일관성을 확보한 점  
- 막연했던 테스트를 직접 작성해보며 성공/실패 케이스의 기준을 체화하게 된 점  

### 보완   
- 단위 테스트 외 통합 테스트 관점은 아직 부족 — 관련 학습 자료 찾아보고 종합 프로젝트 전까지 체계 만들어두기
- 구조 설계는 하고 나서가 아닌 하기 전에 더 깊게 고민하는 습관이 필요 (이번처럼 주말에 계속 리팩토링을 진행해야 할 수도 있음. 시간을 효율적으로 쓰자!!)

### 배운 점  
- 승진님: 스쿼드 세션에서 승진님의 코드를 보며, 객체지향 설계에서 가장 중요한 개념 중 하나인 ‘책임 분리’에 대해 알게 되었다.
지금까지는 내 코드에서 하나의 클래스가 너무 많은 책임을 지고 있었고, 그로 인해 코드의 복잡도가 높아지고 있었음을 인지했다.
이를 계기로 클래스마다 어떤 책임을 맡겨야 할지, 그 기준은 무엇인지에 대해 고민하게 되었고, 자연스럽게 코드 리팩토링을 진행하게 되었다.

- Dangle: 피드백을 통해 RFC 문서를 꼼꼼히 읽는 중요성을 느꼈다.
지금까지는 기능 구현에만 집중하느라 HTTP가 지녀야 할 특성이나 규약, 예외 처리 방식에 대해서는 간과하고 있었다.
특히 OWS 처리나 대소문자 구분 등 세부적인 부분을 놓쳤다는 걸 알게 되면서, 단순히 돌아가는 코드가 아닌 '명세에 맞는 구현'을 위해서는 RFC를 숙지해야겠다는 다짐을 하게 되었다.
<br/>
