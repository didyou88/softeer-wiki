# 1️⃣ 리뷰
**날짜:** 2025.08.18 (월)

### 오늘 작업한 내용
- [x] old path disaptch flow
  - [x] 단일 경로 노드 삽입 후보 산정 모듈 개발
  - [x] 전체 경로 평가 모듈 개발
- [ ] 모듈 조합
  - [ ] 경로 필터링
  - [ ] 유휴 시간 필터링
  - [x] 단일 경로 노드 삽입 후 경로 정보 산출
  - [x] 전체 경로 평가  

</br>

### 작업에서 배운 내용

#### 1. 노드 삽입 위치 후보를 어떻게 산정할까

`InsertCandidateProvider`를 구현하면서 노드 삽입 위치 후보를 어떤 조건으로 산정해야 할지 고민했다.

처음에는 단순하게, 기존 노드를 순차적으로 탐색하며 deadline 범위 안에 들어오는 노드 앞뒤를 후보 슬롯으로 추가하는 방식으로 접근했다.
이 과정에서 두 가지 문제가 생겼다  
1. 후보 슬롯이 중복으로 들어가는 상황이 생겨 `Set`으로 관리해야 하고, 
2. 동작은 되지만 전체 노드를 매번 다 훑어야 한다 

"좀 더 효율적으로 할 수 없을까?"라는 생각이 계속 들었다.
그래서 접근 방식을 바꿔봤다. 모든 노드를 다 보는 대신, 데드라인 기준으로 앞뒤 경계를 찾는 방식이다.  
- **역순 탐색**: `node.time <= endDeadline`인 마지막 노드를 찾는다 → `candidateEndIdx`  
- **순방향 탐색**: `node.time >= startDeadline`인 첫 번째 노드를 찾는다 → `candidateStartIdx`  
- **후보 슬롯 범위**: `(candidateStartIdx + 1)` ~ `candidateEndIdx`  

즉, 기존에는 후보를 “조건에 맞으면 계속 추가”하는 방식이었다면, 지금은 삽입 가능한 범위를 산정하는 방식으로 개선하게 되었다.
복잡한 문제일수록 조건을 만족하는 모든 경우를 찾기보다 범위를 좁히는 기준을 세우면 좀 더 단순해진다는 걸 배웠다.

<br/>

### 어려웠던 점

#### 노드 삽입 위치 엣지 케이스 찾기

코드로만 해결하려고 하니 고려해야 할 상황이 많아 복잡했다.
그래서 손으로 직접 그려보며 케이스를 구분했고, "내가 잘 이해할 수 있는 방식"으로 자문자답을 하면서 정리했다.

##### 주요 케이스
1. 기존 노드의 time과 신규 노드의 deadline이 겹치는 경우  
→ 신규 노드를 그 위치에 껴 넣는다.

2. 신규 노드의 deadline 범위가 유휴 시간 시작 시각을 넘어가는 경우  
→ 유휴 시작보다 늦으므로 유휴 구간 내부에서 배치 고려.

3. 신규 노드의 deadline 범위가 유휴 시간 끝 시각을 넘어가는 경우  
→ 유휴 종료를 초과하므로 다음 후보 구간 탐색 필요.

4. 탑승 노드와 하차 노드를 같은 위치에 삽입해야 하는 경우  
→ 삽입 순서는 반드시 하차 → 탑승.
(탑승을 먼저 넣으면 인덱스가 밀려 정확한 위치에 넣지 못하게 됨.)

복잡한 문제를 풀 때는 머릿속에서만 해결하려 하지 말고, 시각화와 도식화해서 조건별로 나누고 직접 설명하듯 정리하는 과정이 필요하다.
하나씩 그려가는 과정이 귀찮을 수는 있으나, 길게 보면 나 말고 다른 사람도 내 코드를 이해하고 로직을 작성해야 하기 때문에 설명 시간을 줄일 수 있다.

<br/>

#  2️⃣ 회고 (KPT)

### KEEP (잘한 점 / 유지하고 싶은 습관)

#### K1. 배차 알고리즘 버저닝 도입

회의와 개발을 반복하다 보니 큰 줄기나 조건이 중간에 바뀌는 경우가 종종 있었다.
페어 프로그래밍을 하면서 각자 맡은 파트를 개발하다 보니, 변경 사항이 생기면 누가 어떤 시점에 무엇을 기준으로 작업했는지 헷갈리는 일이 발생했다.

그래서 노션 페이지에 버전을 기록하고, 버전별로 어떤 변경이 있었는지 남기기 시작했다.
덕분에 동료가 짠 코드가 이해가지 않아서 흐름이 끊기는 횟수가 줄어들었고, 집중해서 작업을 이어갈 수 있었다.

<br/>

### Problem (아쉬웠던 점 / 놓친 부분)

#### P1. 남은 시간 일주일, 체력이 떨어지고 있다

개발 기간이 이제 일주일밖에 남지 않았다.
후회 없이 최선을 다하고 싶지만, 체력이 점점 떨어지고 있다.
밤 1시쯤이면 너무 피곤해서 작은 이슈에도 오래 동안 쳐다보게 된다.

<br/>

### Try (다음에 시도할 것 / 개선 방향)

#### T1. 최선을 다한다는 게 밤을 새는 건 아니다

같은 시간이라도 정신이 맑을 때의 효율이 훨씬 높다는 걸 느꼈다.
밤을 새우는 대신 최소한의 수면은 꼭 지키고, 커피는 하루 한 잔 정도로 줄여 집중력을 유지 해야 겠다.
“오래 하는 것”보다 “집중해서 제대로 하는 것”이 훨씬 중요하다.
배차 알고리즘이 복잡한 만큼 비몽사몽한 상태로 하면 다음날 보았을 때 로직 오류가 발생한다.
집중해서 제대로 하자!

<br/>
